doctype 5
html.no-js(lang='en')
  head
    meta(charset='UTF-8')
    title Pryv API - !{title ||Â 'TODO'}
    meta(name='description', content='TODO')
    meta(name='viewport', content='width=device-width, initial-scale=1')
    link(rel='stylesheet', type='text/css', href='bootstrap/css/bootstrap.min.css')
    link(rel='stylesheet', type='text/css', href='style.css')
    link(rel='stylesheet', type='text/css', href='bootstrap/css/bootstrap-responsive.min.css')
    link(rel='stylesheet', type='text/css', href='http://fonts.googleapis.com/css?family=PT+Sans')
    link(rel='stylesheet', type='text/css', href='fonts/stylesheet.css')
    script(src='scripts/modernizr.min.js')
    script(src='http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js')
    script(src='scripts/jquery.toc.min.js')
    script(src='bootstrap/js/bootstrap.min.js')
    link(rel='stylesheet', type='text/css', href='highlight.css')
    script(src='highlight/highlight.pack.js')
    script
      hljs.initHighlightingOnLoad();

    script
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-36589447-2']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

  - var bodyClass = (withTOC ? 'with-toc' : '') + (withExamples ? ' with-examples' : '')
  - var isLanding = false;
  - try { isLanding = landingPage; } catch (e) {}
  - if (isLanding) bodyClass += 'landing-page'
  body(class=bodyClass)
    header#page-header.navbar.navbar-fixed-top
      .navbar-inner
        a.brand(href='dev-index.html') Pryv
        a.btn.btn-navbar(data-toggle='collapse', data-target='.nav-collapse')
          span.icon-bar
          span.icon-bar
          span.icon-bar
        .nav-collapse.collapse
          ul.nav
            //- TODO: generate this menu from data
            li
              a(href='#{meta.pages.linkTo("about")}') About
            li
              a(href='#{meta.pages.linkTo("concepts")}') Concepts
            li
              a(href='#{meta.pages.linkTo("reference")}') API reference
            li
              a(href='#{meta.pages.linkTo("eventTypes")}') Event types
            li
              a(href='#{meta.pages.linkTo("appAccess")}') App access
            li.dropdown
              a.dropdown-toggle(href='#', data-toggle='dropdown') More <b class="caret"></b>
              ul.dropdown-menu
                li
                  a(href='#{meta.pages.linkTo("appsAndServices")}') Pryv apps and services
                li
                  a(href='#{meta.pages.linkTo("codeLibraries")}') Code libraries
            //li.dropdown
              a.dropdown-toggle(href='#', data-toggle='dropdown') Guides <b class="caret"></b>
              ul.dropdown-menu
                li
                  a(href='#') Getting started
                li
                  a(href='#') Data modeling
            //li.dropdown
              a.dropdown-toggle(href='#', data-toggle='dropdown') Reference <b class="caret"></b>
              ul.dropdown-menu
                li
                  a(href='#{meta.pages.linkTo("reference")}') API
                li
                  a(href='#{meta.pages.linkTo("eventTypes")}') Event types
                li
                  a(href='#{meta.pages.linkTo("standardStructure")}') Standard data structure
                li
                  a(href='#{meta.pages.linkTo("appAccess")}') App authorization
            //li
              a(href='#') Blog
        .nav-header.pull-right
          ul.nav.nav-pills.examples-menu
            if withExamples && withExamples.menu
              li
                p.navbar-text Examples:&nbsp;
              li.json.active
                a(href='javascript:showExamples("json")') Raw JSON
              li.http
                a(href='javascript:showExamples("http")') HTTP
              li.sockets
                a(href='javascript:showExamples("sockets")') Socket.IO
              li.divider-vertical
            li
              p.navbar-text.version API version: <strong>#{apiReference.version}</strong>

    #main-wrapper.container
      #main.row!= yield
      - if (withTOC)
        - var selectors = 'h1,h2'
        - try { selectors = tocSelectors; } catch (e) {}
        #toc
        //- content generated by TOC plugin (see below)

        //- TOC generation assumes that all headings are within a section, and that there is a single
        //- level 1 heading (h1) per section (the section title)
        script
          jQuery(document).ready(function($) {
            $('#toc').toc({
              'selectors': '#{selectors}',
              'container': '#main',
              'smoothScrolling': false,
              'prefix': 'toc',
              'onHighlight': function(el) {},
              'highlightOnScroll': true,
              'highlightOffset': 100,
              'anchorName': function(i, heading, prefix) {
                var $heading = $(heading),
                    sectionId = $heading.parents('section[id]').attr('id');
                return sectionId + ($heading.is('h1') ? '' : '-' + slugify($heading.text()));
              },
              'headerText': function(i, heading, $heading) {
                return $heading.text();
              }
            });

            function slugify(text) {
              return text.toLowerCase().replace(/[^\w- ]+/g,'').replace(/ +/g,'-');
            }
          });

      if withExamples && withExamples.menu
        script
          function showExamples(format) {
            var removeSelectors = [];
            ['json', 'http', 'sockets'].forEach(function(f) {
              if (format !== f) {
                removeSelectors.push('.examples-menu li.' + f + '.active');
                removeSelectors.push('.example .tab-pane.' + f + '.active');
              }
            });
            $(removeSelectors.join(',')).removeClass("active");
            $('.examples-menu li.' + format + ', .example .tab-pane.' + format).addClass("active");
          }
