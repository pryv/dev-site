-// TODO: remove duplication with default layout
doctype 5
html.no-js(lang='en')
  head
    meta(charset='UTF-8')
    title Pryv API - !{document.title ||Â 'TODO'}
    meta(name='description', content='TODO')
    meta(name='viewport', content='width=device-width, initial-scale=1')
    link(rel='stylesheet', type='text/css', href='bootstrap/css/bootstrap.min.css')
    //link(rel='stylesheet', type='text/css', href='github.css')
    link(rel='stylesheet', type='text/css', href='highlight.css')
    link(rel='stylesheet', type='text/css', href='style.css')
    link(rel='stylesheet', type='text/css', href='bootstrap/css/bootstrap-responsive.min.css')
    link(rel='stylesheet', type='text/css', href='http://fonts.googleapis.com/css?family=PT+Sans')
    link(rel='stylesheet', type='text/css', href='fonts/stylesheet.css')
    script(src='scripts/modernizr.min.js')
    script(src='http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js')
    script(src='scripts/jquery.toc.min.js')
    script(src='bootstrap/js/bootstrap.min.js')

    script
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-36589447-2']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

  - var bodyClass = (document.withTOC ? 'with-toc' : '') + (document.withExamples ? ' with-examples' : '') + (document.landingPage ? 'landing-page' : '')
  body(class=bodyClass)
    header#page-header.navbar.navbar-fixed-top
      .navbar-inner
        a.brand(href='dev-index.html') Pryv
        a.btn.btn-navbar(data-toggle='collapse', data-target='.nav-collapse')
          span.icon-bar
          span.icon-bar
          span.icon-bar
        .nav-collapse.collapse
          ul.nav
            //- TODO: generate this menu from data
            li
              a(href='about.html') About
            li
              a(href='concepts.html') Concepts
            li
              a(href='reference.html') API reference
            li
              a(href='event-typez.html') Event types
            //li.dropdown
              a.dropdown-toggle(href='#', data-toggle='dropdown') Guides <b class="caret"></b>
              //- TODO: make dropdown menu work...
              ul.dropdown-menu
                li
                  a(href='#') Getting started
                li
                  a(href='#') Data modeling
            //li.dropdown
              a.dropdown-toggle(href='#', data-toggle='dropdown') Reference <b class="caret"></b>
              ul.dropdown-menu
                li
                  a(href='reference.html') API
                li
                  a(href='event-typez.html') Event types
                li
                  a(href='standard-structure.html') Standard data structure
                li
                  a(href='app-access.html') App authorization
            //li
              a(href='#') Blog
        - var apiVersion = '0.6.0' // do not change this line without updating `update-api-version.bash`
        .nav-header.pull-right
          .version API version: <strong>#{apiVersion}</strong>

    #main-wrapper.container
      #main.row

        - if (document.withTOC)
            #toc.span3
            //- content generated by TOC plugin (see below)

            //- TOC generation assumes that all headings are within a section, and that there is a single
            //- level 1 heading (h1) per section (the section title)
            script
              jQuery(document).ready(function($) {
                $('#toc').toc({
                  'selectors': 'h1,h2',
                  'container': '#main',
                  'smoothScrolling': false,
                  'prefix': 'toc',
                  'onHighlight': function(el) {},
                  'highlightOnScroll': true,
                  'highlightOffset': 100,
                  'anchorName': function(i, heading, prefix) {
                    var $heading = $(heading),
                        sectionId = $heading.parents('section[id]').attr('id');
                    return sectionId + ($heading.is('h1') ? '' : '-' + slugify($heading.text()));
                  },
                  'headerText': function(i, heading, $heading) {
                    return $heading.text();
                  }
                });

                function slugify(text) {
                  return text.toLowerCase().replace(/[^\w- ]+/g,'').replace(/ +/g,'-');
                }
              });
        .span9
            !{content}
